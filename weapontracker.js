//Shadowbringers Bosses
const TIT_WEPS = [
    {
        id: 'titCheck',
        class: 'titPLD',
        boss: 'TITANIA',
        src: 'images/icons/tank/PLD.png',
        name: "The King's Sword",
    },
    {
        id: 'titCheck',
        class: 'titWAR',
        boss: 'TITANIA',
        src: 'images/icons/tank/WAR.png',
        name: "The King's Axe",
    },
    {
        id: 'titCheck',
        class: 'titDRK',
        boss: 'TITANIA',
        src: 'images/icons/tank/DRK.png',
        name: "The King's Guillotine",
    },
    {
        id: 'titCheck',
        class: 'titGNB',
        boss: 'TITANIA',
        src: 'images/icons/tank/GNB.png',
        name: "The King's Manatrigger",
    },
    {
        id: 'titCheck',
        class: 'titWHM',
        boss: 'TITANIA',
        src: 'images/icons/healer/WHM.png',
        name: "The King's Cane",
    },
    {
        id: 'titCheck',
        class: 'titSCH',
        boss: 'TITANIA',
        src: 'images/icons/healer/SCH.png',
        name: "The King's Codex",
    },
    {
        id: 'titCheck',
        class: 'titAST',
        boss: 'TITANIA',
        src: 'images/icons/healer/AST.png',
        name: "The King's Starglobe",
    },
    {
        id: 'titCheck',
        class: 'titMNK',
        boss: 'TITANIA',
        src: 'images/icons/dps/MNK.png',
        name: "The King's Claws",
    },
    {
        id: 'titCheck',
        class: 'titDRG',
        boss: 'TITANIA',
        src: 'images/icons/dps/DRG.png',
        name: "The King's Spear",
    },
    {
        id: 'titCheck',
        class: 'titNIN',
        boss: 'TITANIA',
        src: 'images/icons/dps/NIN.png',
        name: "The King's Cleavers",
    },
    {
        id: 'titCheck',
        class: 'titSAM',
        boss: 'TITANIA',
        src: 'images/icons/dps/SAM.png',
        name: "The King's Katana",
    },
    {
        id: 'titCheck',
        class: 'titBRD',
        boss: 'TITANIA',
        src: 'images/icons/dps/BRD.png',
        name: "The King's Longbow",
    },
    {
        id: 'titCheck',
        class: 'titMCH',
        boss: 'TITANIA',
        src: 'images/icons/dps/MCH.png',
        name: "The King's Handgonne",
    },
    {
        id: 'titCheck',
        class: 'titDNC',
        boss: 'TITANIA',
        src: 'images/icons/dps/DNC.png',
        name: "The King's Tathlums",
    },
    {
        id: 'titCheck',
        class: 'titBLM',
        boss: 'TITANIA',
        src: 'images/icons/dps/BLM.png',
        name: "The King's Rod",
    },
    {
        id: 'titCheck',
        class: 'titSMN',
        boss: 'TITANIA',
        src: 'images/icons/dps/SMN.png',
        name: "The King's Grimoire",
    },
    {
        id: 'titCheck',
        class: 'titRDM',
        boss: 'TITANIA',
        src: 'images/icons/dps/RDM.png',
        name: "The King's Rapier",
    },
]

const HAD_WEPS = [
    {
        id: 'hadCheck',
        class: 'hadPLD',
        boss: 'HADES',
        src: 'images/icons/tank/PLD.png',
        name: "Misos",
    },
    {
        id: 'hadCheck',
        class: 'hadWAR',
        boss: 'HADES',
        src: 'images/icons/tank/WAR.png',
        name: "Thumosis",
    },
    {
        id: 'hadCheck',
        class: 'hadDRK',
        boss: 'HADES',
        src: 'images/icons/tank/DRK.png',
        name: "Eleos",
    },
    {
        id: 'hadCheck',
        class: 'hadGNB',
        boss: 'HADES',
        src: 'images/icons/tank/GNB.png',
        name: "Odune",
    },
    {
        id: 'hadCheck',
        class: 'hadWHM',
        boss: 'HADES',
        src: 'images/icons/healer/WHM.png',
        name: "Kelesis",
    },
    {
        id: 'hadCheck',
        class: 'hadSCH',
        boss: 'HADES',
        src: 'images/icons/healer/SCH.png',
        name: "Enochlesis",
    },
    {
        id: 'hadCheck',
        class: 'hadAST',
        boss: 'HADES',
        src: 'images/icons/healer/AST.png',
        name: "Himeros",
    },
    {
        id: 'hadCheck',
        class: 'hadMNK',
        boss: 'HADES',
        src: 'images/icons/dps/MNK.png',
        name: "Zelos",
    },
    {
        id: 'hadCheck',
        class: 'hadDRG',
        boss: 'HADES',
        src: 'images/icons/dps/DRG.png',
        name: "Menis",
    },
    {
        id: 'hadCheck',
        class: 'hadNIN',
        boss: 'HADES',
        src: 'images/icons/dps/NIN.png',
        name: "Phthonos",
    },
    {
        id: 'hadCheck',
        class: 'hadSAM',
        boss: 'HADES',
        src: 'images/icons/dps/SAM.png',
        name: "Aischune",
    },
    {
        id: 'hadCheck',
        class: 'hadBRD',
        boss: 'HADES',
        src: 'images/icons/dps/BRD.png',
        name: "Deima",
    },
    {
        id: 'hadCheck',
        class: 'hadMCH',
        boss: 'HADES',
        src: 'images/icons/dps/MCH.png',
        name: "Ekplexis",
    },
    {
        id: 'hadCheck',
        class: 'hadDNC',
        boss: 'HADES',
        src: 'images/icons/dps/DNC.png',
        name: "Zelotupia",
    },
    {
        id: 'hadCheck',
        class: 'hadBLM',
        boss: 'HADES',
        src: 'images/icons/dps/BLM.png',
        name: "Oknos",
    },
    {
        id: 'hadCheck',
        class: 'hadSMN',
        boss: 'HADES',
        src: 'images/icons/dps/SMN.png',
        name: "Epikairekakia",
    },
    {
        id: 'hadCheck',
        class: 'hadRDM',
        boss: 'HADES',
        src: 'images/icons/dps/RDM.png',
        name: "Agonia",
    },
]

const TITANIA = {
    id: 'titCheck',
    class: 'titPercent',
    name: 'Titania',
    array: TIT_WEPS,
}

const HADES = {
    id: 'hadCheck',
    class: 'hadPercent',
    name: 'Hades',
    array: HAD_WEPS,
}

//Endwalker Bosses
const HYD_WEPS = [
    {
        id: 'hydCheck',
        class: 'hydPLD',
        boss: 'HYDAELYN',
        src: 'images/icons/tank/PLD.png',
        name: 'Bastard Sword of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydWAR',
        boss: 'HYDAELYN',
        src: 'images/icons/tank/WAR.png',
        name: 'Labrys of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydDRK',
        boss: 'HYDAELYN',
        src: 'images/icons/tank/DRK.png',
        name: 'Greatsword of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydGNB',
        boss: 'HYDAELYN',
        src: 'images/icons/tank/GNB.png',
        name: 'Gunblade of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydWHM',
        boss: 'HYDAELYN',
        src: 'images/icons/healer/WHM.png',
        name: 'Cane of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydSCH',
        boss: 'HYDAELYN',
        src: 'images/icons/healer/SCH.png',
        name: 'Codex of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydAST',
        boss: 'HYDAELYN',
        src: 'images/icons/healer/AST.png',
        name: 'Torquetum of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydSGE',
        boss: 'HYDAELYN',
        src: 'images/icons/healer/SGE.png',
        name: 'Wings of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydMNK',
        boss: 'HYDAELYN',
        src: 'images/icons/dps/MNK.png',
        name: 'Sainti of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydDRG',
        boss: 'HYDAELYN',
        src: 'images/icons/dps/DRG.png',
        name: 'Partisan of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydNIN',
        boss: 'HYDAELYN',
        src: 'images/icons/dps/NIN.png',
        name: 'Daggers of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydSAM',
        boss: 'HYDAELYN',
        src: 'images/icons/dps/SAM.png',
        name: 'Blade of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydRPR',
        boss: 'HYDAELYN',
        src: 'images/icons/dps/RPR.png',
        name: 'War Scythe of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydBRD',
        boss: 'HYDAELYN',
        src: 'images/icons/dps/BRD.png',
        name: 'Longbow of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydMCH',
        boss: 'HYDAELYN',
        src: 'images/icons/dps/MCH.png',
        name: 'Pistol of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydDNC',
        boss: 'HYDAELYN',
        src: 'images/icons/dps/DNC.png',
        name: 'Tathlums of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydBLM',
        boss: 'HYDAELYN',
        src: 'images/icons/dps/BLM.png',
        name: 'Rod of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydSMN',
        boss: 'HYDAELYN',
        src: 'images/icons/dps/SMN.png',
        name: 'Grimoire of Divine Light',
    },
    {
        id: 'hydCheck',
        class: 'hydRDM',
        boss: 'HYDAELYN',
        src: 'images/icons/dps/RDM.png',
        name: 'Foil of Divine Light',
    },
]

const END_WEPS = [
    {
        id: 'endCheck',
        class: 'endPLD',
        boss: 'ENDSINGER',
        src: 'images/icons/tank/PLD.png',
        name: 'Bluefeather Sword',
    },
    {
        id: 'endCheck',
        class: 'endWAR',
        boss: 'ENDSINGER',
        src: 'images/icons/tank/WAR.png',
        name: 'Bluefeather Axe',
    },
    {
        id: 'endCheck',
        class: 'endDRK',
        boss: 'ENDSINGER',
        src: 'images/icons/tank/DRK.png',
        name: 'Bluefeather Faussar',
    },
    {
        id: 'endCheck',
        class: 'endGNB',
        boss: 'ENDSINGER',
        src: 'images/icons/tank/GNB.png',
        name: 'Bluefeather Bayonet',
    },
    {
        id: 'endCheck',
        class: 'endWHM',
        boss: 'ENDSINGER',
        src: 'images/icons/healer/WHM.png',
        name: 'Bluefeather Wand',
    },
    {
        id: 'endCheck',
        class: 'endSCH',
        boss: 'ENDSINGER',
        src: 'images/icons/healer/SCH.png',
        name: 'Bluefeather Codex',
    },
    {
        id: 'endCheck',
        class: 'endAST',
        boss: 'ENDSINGER',
        src: 'images/icons/healer/AST.png',
        name: 'Bluefeather Torquetum',
    },
    {
        id: 'endCheck',
        class: 'endSGE',
        boss: 'ENDSINGER',
        src: 'images/icons/healer/SGE.png',
        name: 'Bluefeather Wings',
    },
    {
        id: 'endCheck',
        class: 'endMNK',
        boss: 'ENDSINGER',
        src: 'images/icons/dps/MNK.png',
        name: 'Bluefeather Tonfa',
    },
    {
        id: 'endCheck',
        class: 'endDRG',
        boss: 'ENDSINGER',
        src: 'images/icons/dps/DRG.png',
        name: 'Bluefeather Halberd',
    },
    {
        id: 'endCheck',
        class: 'endNIN',
        boss: 'ENDSINGER',
        src: 'images/icons/dps/NIN.png',
        name: 'Bluefeather Knives',
    },
    {
        id: 'endCheck',
        class: 'endSAM',
        boss: 'ENDSINGER',
        src: 'images/icons/dps/SAM.png',
        name: 'Bluefeather Tachi',
    },
    {
        id: 'endCheck',
        class: 'endRPR',
        boss: 'ENDSINGER',
        src: 'images/icons/dps/RPR.png',
        name: 'Bluefeather Zaghnal',
    },
    {
        id: 'endCheck',
        class: 'endBRD',
        boss: 'ENDSINGER',
        src: 'images/icons/dps/BRD.png',
        name: 'Bluefeather Longbow',
    },
    {
        id: 'endCheck',
        class: 'endMCH',
        boss: 'ENDSINGER',
        src: 'images/icons/dps/MCH.png',
        name: 'Bluefeather Musketoon',
    },
    {
        id: 'endCheck',
        class: 'endDNC',
        boss: 'ENDSINGER',
        src: 'images/icons/dps/DNC.png',
        name: 'Bluefeather Doomsbanes',
    },
    {
        id: 'endCheck',
        class: 'endBLM',
        boss: 'ENDSINGER',
        src: 'images/icons/dps/BLM.png',
        name: 'Bluefeather Rod',
    },
    {
        id: 'endCheck',
        class: 'endSMN',
        boss: 'ENDSINGER',
        src: 'images/icons/dps/SMN.png',
        name: 'Bluefeather Grimoire',
    },
    {
        id: 'endCheck',
        class: 'endRDM',
        boss: 'ENDSINGER',
        src: 'images/icons/dps/RDM.png',
        name: 'Bluefeather Rapier',
    },
]

const HYDAELYN = {
    id: 'hydCheck',
    class: 'hydPercent',
    name: 'Hydaelyn',
    array: HYD_WEPS,
}

const ENDSINGER = {
    id: 'endCheck',
    class: 'endPercent',
    name: 'Endsinger',
    array: END_WEPS,
}

function updatePercent(arrayName) {
    let percentCount = document.querySelectorAll('input[id=' + arrayName.id + ']:checked').length;
    document.getElementById(arrayName.class).innerHTML = arrayName.name + " - " + Math.trunc(percentCount / arrayName.array.length * 100) + "%";
}

function updateCount(bossCheck, bossPercent, bossName, arrayName, weaponClass) {
    let percentCount = document.querySelectorAll('input[id=' + bossCheck + ']:checked').length;
    document.getElementById(bossPercent).innerHTML = bossName + " - " + Math.trunc(percentCount / arrayName.length * 100) + "%";
    if (getCookie(weaponClass) === 'hidden') {
    setCookie(weaponClass, 'show', 30);
    }
    else {
        setCookie(weaponClass, 'hidden', 30);
    }
}

function addWeaponInputRow(idName, className, bossName, srcName, wepName, bossID) {
    let checkbox = document.createElement('input');
    checkbox.setAttribute('type', 'checkbox');
    checkbox.setAttribute('id', idName);
    checkbox.setAttribute('class', className);
    classString = 
    checkbox.setAttribute('onClick', 'updateCount(' + bossName + '.id, ' + bossName + '.class, ' + bossName + '.name, ' + bossName + '.array, ' + '"' + String(className) + '"' + ')');
    if (getCookie(className) == 'show') {
        console.log("Success!");
        checkbox.setAttribute('checked', 'true');
    }

    let jobIcon = document.createElement('img');
    jobIcon.setAttribute('id', 'classIcon');
    jobIcon.setAttribute('src', srcName);

    let name = document.createElement('label');
    name.setAttribute('class', className);
    name.innerHTML = wepName;

    const element = document.getElementById(bossID)
    element.appendChild(checkbox);
    element.appendChild(jobIcon);
    element.appendChild(name);
}

function drawWeps(boss_weps, bossID) {
    boss_weps.forEach(weapon => {
        addWeaponInputRow(weapon.id, weapon.class, weapon.boss, weapon.src, weapon.name, bossID);
        if (getCookie(weapon.class) == "") {
            setCookie(weapon.class, 'hidden', 30);
        }
    })
}

function pageLoadDrawWeps() {
    drawWeps(HYD_WEPS, 'hydaelyn');
    updatePercent(HYDAELYN);
    drawWeps(END_WEPS, 'endsinger');
    updatePercent(ENDSINGER);
    drawWeps(TIT_WEPS, 'titania');
    updatePercent(TITANIA);
    drawWeps(HAD_WEPS, 'hades');
    updatePercent(HADES);
}

function setCookie(cname, cvalue, exdays) {
    const date = new Date();
    date.setTime(date.getTime() + (exdays*24*60*60*1000));
    let expires = "expires=" + date.toUTCString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
    let name = cname + "=";
    let decodedCookie = decodeURIComponent(document.cookie);
    let ca = decodedCookie.split(';');
    for(let i = 0; i <ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
  }